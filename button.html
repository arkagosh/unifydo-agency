<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <style>
        :root {
            --bg-day: #5ebfff;
            --bg-night: #010204;
            --track-day: #0099ff;
            --track-night: #0f172a;
        }

        body {
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: var(--bg-day);
            transition: background 1.5s ease;
            overflow: hidden;
        }

        .goo-wrapper {
            filter: url('#clean-goo');
            transform: scale(1.6);
        }

        .container {
            position: relative;
            cursor: pointer;
        }

        .track {
            width: 260px;
            height: 110px;
            background: var(--track-day);
            border-radius: 100px;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 10px 30px rgba(0,0,0,0.5), 0 20px 40px rgba(0,0,0,0.3);
        }

        /* --- THE REALISTIC SUN --- */
        .knob {
            position: absolute;
            top: 10px;
            left: 10px;
            width: 90px;
            height: 90px;
            border-radius: 50%;
            z-index: 10;
            display: flex;
            justify-content: center;
            align-items: center;
            /* High-intensity solar gradient */
            background: radial-gradient(circle at 35% 35%, 
                #ffffff 0%, 
                #fff7ad 20%, 
                #ffcf10 50%, 
                #ff8000 100%);
            box-shadow: 0 0 50px rgba(255, 166, 0, 0.6);
        }

        /* Atmospheric Glow Layers */
        .corona {
            position: absolute;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255,180,0,0.4) 0%, transparent 70%);
            pointer-events: none;
        }
        .inner-corona { width: 140px; height: 140px; filter: blur(15px); }
        .outer-corona { width: 200px; height: 200px; filter: blur(30px); opacity: 0.3; }

        /* Ray Styling */
        .ray {
            stroke: #ff9d00;
            stroke-width: 4;
            stroke-linecap: round;
            filter: drop-shadow(0 0 5px #ff5100);
        }

        /* Realistic Cloud Blobs */
        .cloud-part {
            position: absolute;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 50%;
            filter: blur(5px);
        }

        /* Fog Layers */
        .fog-layer {
            position: absolute;
            bottom: -10px;
            width: 200%;
            height: 40%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            opacity: 0;
            pointer-events: none;
        }

        .star {
            position: absolute;
            background: #fff;
            border-radius: 50%;
            opacity: 0;
            box-shadow: 0 0 8px 1px #fff;
        }

        .crater { fill: #334155; opacity: 0; }
    </style>
</head>
<body>

<svg style="position: absolute; width: 0; height: 0;">
    <defs>
        <filter id="clean-goo">
            <feGaussianBlur in="SourceGraphic" stdDeviation="7" result="blur" />
            <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 24 -11" result="goo" />
            <feComposite in="SourceGraphic" in2="goo" operator="atop" />
        </filter>
        <mask id="moon-mask">
            <rect width="100" height="100" fill="white" />
            <circle id="mask-circle" cx="135" cy="25" r="42" fill="black" />
        </mask>
    </defs>
</svg>

<div class="goo-wrapper">
    <div class="container" id="toggle-btn">
        <div class="track" id="track">
            <div class="fog-layer" id="fog"></div>
            <div class="star" style="width: 3px; height: 3px; top: 20%; left: 30%;"></div>
            <div class="star" style="width: 2px; height: 2px; top: 55%; left: 45%;"></div>
            <div class="star" style="width: 4px; height: 4px; top: 35%; left: 15%;"></div>

            <div id="clouds">
                <div class="cloud-part" style="width: 90px; height: 70px; top: 20px; left: 150px;"></div>
                <div class="cloud-part" style="width: 60px; height: 50px; top: 50px; left: 180px;"></div>
                <div class="cloud-part" style="width: 80px; height: 60px; top: 10px; left: 195px;"></div>
            </div>
        </div>
        
        <div class="knob" id="knob">
            <div class="corona inner-corona" id="inner-c"></div>
            <div class="corona outer-corona" id="outer-c"></div>
            
            <svg viewBox="0 0 100 100" id="ray-svg" style="width: 140%; height: 140%; position: absolute;">
                <g id="ray-group">
                    <line class="ray" x1="50" y1="5" x2="50" y2="15" />
                    <line class="ray" x1="50" y1="95" x2="50" y2="85" />
                    <line class="ray" x1="5" y1="50" x2="15" y2="50" />
                    <line class="ray" x1="95" y1="50" x2="85" y2="50" />
                </g>
            </svg>

            <svg viewBox="0 0 100 100" style="width: 80%; height: 80%; position: absolute;">
                <g mask="url(#moon-mask)">
                    <circle cx="50" cy="50" r="40" fill="transparent" />
                </g>
                <circle class="crater" cx="30" cy="35" r="6" />
                <circle class="crater" cx="55" cy="55" r="9" />
                <circle class="crater" cx="40" cy="70" r="4" />
            </svg>
        </div>
    </div>
</div>

<script>
    const btn = document.getElementById('toggle-btn');
    const knob = document.getElementById('knob');
    const track = document.getElementById('track');
    const maskCircle = document.getElementById('mask-circle');
    const rayGroup = document.getElementById('ray-group');
    let isNight = false;

    // 1. Idle Animations: Sun Plasma & Cloud Drift
    gsap.to(".inner-corona", { scale: 1.2, opacity: 0.6, duration: 2, repeat: -1, yoyo: true });
    gsap.to("#ray-svg", { rotation: 360, duration: 20, repeat: -1, ease: "linear" });
    gsap.to(".cloud-part", { 
        x: "random(-15, 15)", 
        y: "random(-5, 5)", 
        duration: "random(3, 5)", 
        repeat: -1, 
        yoyo: true, 
        ease: "sine.inOut" 
    });

    btn.addEventListener('click', () => {
        isNight = !isNight;
        const tl = gsap.timeline({ defaults: { ease: "expo.out", duration: 1 } });

        // 2. The Sun -> Moon Transition
        tl.to(knob, {
            x: isNight ? 150 : 0,
            background: isNight 
                ? "radial-gradient(circle at 35% 35%, #f8fafc 0%, #cbd5e1 50%, #64748b 100%)" 
                : "radial-gradient(circle at 35% 35%, #ffffff 0%, #fff7ad 20%, #ffcf10 50%, #ff8000 100%)",
            boxShadow: isNight ? "0 0 30px rgba(255,255,255,0.3)" : "0 0 50px rgba(255, 166, 0, 0.6)"
        }, 0);

        // 3. Corona & Rays "Burn out"
        tl.to(".corona", { opacity: 0, scale: 0.5 }, 0);
        tl.to("#ray-svg", { scale: isNight ? 0 : 1, opacity: isNight ? 0 : 1, rotate: isNight ? 90 : 0 }, 0);

        // 4. Moon Mask & Craters
        tl.to(maskCircle, { cx: isNight ? 82 : 135, cy: isNight ? 32 : 25 }, 0);
        tl.to(".crater", { opacity: isNight ? 0.3 : 0 }, 0.5);

        // 5. Environmental Shift
        tl.to(".cloud-part", { x: isNight ? -300 : 0, opacity: isNight ? 0 : 1, stagger: 0.05 }, 0);
        tl.to(".star", { opacity: isNight ? 1 : 0, y: isNight ? 0 : 20, stagger: 0.1 }, 0);
        tl.to("#fog", { opacity: isNight ? 1 : 0 }, 0);

        // 6. Global Theme
        gsap.to(document.body, { backgroundColor: isNight ? "#010204" : "#5ebfff" });
        gsap.to(track, { backgroundColor: isNight ? "#0f172a" : "#0099ff" });
    });
</script>

</body>
</html>
